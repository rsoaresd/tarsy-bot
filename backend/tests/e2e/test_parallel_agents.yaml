# Test agent configuration for parallel execution E2E tests
# This file defines test chains for parallel agent execution scenarios

agents:
  # Kubernetes specialist agent for parallel multi-agent testing
  KubernetesAgent:
    custom_instructions: |
      You are a Kubernetes specialist analyzing pod health and resource issues.
      Focus on pod status, events, and resource constraints.
    mcp_servers:
      - "kubernetes-server"
  
  # Log analysis agent for parallel multi-agent testing
  LogAgent:
    custom_instructions: |
      You are a log analysis specialist focusing on application errors and patterns.
      Analyze logs to identify root causes and anomalies.
    mcp_servers:
      - "kubernetes-server"
  
  # Command agent for formulating remediation steps
  CommandAgent:
    custom_instructions: |
      You are a command execution specialist that formulates remediation steps based on investigation results.
    mcp_servers:
      - "kubernetes-server"

# MCP servers for test environment
# Note: Using builtin kubernetes-server for all agents to simplify test setup

# Agent chains configuration
agent_chains:
  # Test chain 1: Multi-agent parallel stage with automatic synthesis
  multi-agent-parallel-chain:
    alert_types:
      - "test-parallel-execution"
    stages:
      - name: "investigation"
        agents:
          - name: "KubernetesAgent"
            llm_provider: "google-default"
            iteration_strategy: "native-thinking"
          - name: "LogAgent"
            llm_provider: "anthropic-default"
            iteration_strategy: "react"
        success_policy: "all"  # Both must succeed
        # Synthesis configuration (test uses ReAct mocks)
        synthesis:
          agent: "SynthesisAgent"
          iteration_strategy: "synthesis-native-thinking"
          llm_provider: "google-default"
    description: "Multi-agent parallel stage with automatic synthesis (final stage)"
  
  # Test chain 2: Replica parallel stage with automatic synthesis
  replica-parallel-chain:
    alert_types:
      - "test-replica-execution"
    stages:
      - name: "analysis"
        agent: "KubernetesAgent"
        replicas: 3
        llm_provider: "google-default"
        iteration_strategy: "native-thinking"
        success_policy: "any"  # At least one must succeed
        # Synthesis configuration (test uses simple synthesis strategy)
        synthesis:
          agent: "SynthesisAgent"
          iteration_strategy: "synthesis"
          llm_provider: "anthropic-default"
    description: "Replica parallel stage (3 replicas) with automatic synthesis"
  
  # Test chain 3: Parallel stage with auto-synthesis followed by regular stage
  parallel-then-regular-chain:
    alert_types:
      - "test-parallel-regular-execution"
    stages:
      - name: "investigation"
        agents:
          - name: "KubernetesAgent"
            llm_provider: "google-default"
            iteration_strategy: "native-thinking"
          - name: "LogAgent"
            llm_provider: "anthropic-default"
            iteration_strategy: "react"
        success_policy: "all"
        # Note: synthesis config is optional and omitted here to test defaults
        # Automatic synthesis will use: SynthesisAgent with 'synthesis' strategy
      - name: "command"
        agent: "CommandAgent"
        iteration_strategy: "react-final-analysis"
        llm_provider: "google-default"
    description: "Parallel stage with automatic synthesis followed by regular stage"
  